if(!require(plotly)) install.packages('plotly')
library(plotly)
if(!require(tidyverse)) install.packages('tidyverse')
library(tidyverse)
setwd("~/GitHub/Brazilian-Milk-Production")
milk_production_states <- read.csv2('spreadsheet/table74_brazil.csv', skip = 3, nrows = 31, stringsAsFactors = FALSE, encoding = "UTF-8")
milk_production_states <- milk_production_states[-(1:2),]
milk_production_states <- milk_production_states[-29,]
colnames(milk_production_states) <- gsub("X", '', colnames(milk_production_states))
colnames(milk_production_states)[1] <- "Brazilian_States"
for(i in 2:ncol(milk_production_states)){
milk_production_states[,i] <- gsub("[...]", '0', milk_production_states[,i])
milk_production_states[,i] <- as.numeric(as.character(unlist(milk_production_states[,i])))
}
milk_production_states <- milk_production_states %>%
gather(year, value, 2:45)
milk_production_states$year <- as.numeric(milk_production_states$year)
milk_production_states_1 <- milk_production_states %>%
group_by(year) %>%
mutate(rank = rank(-value),
Value_lbl = paste0(" ", round((value * 1000) / 1000000000, 2))) %>%
filter(rank <= 10) %>%
ungroup()
if(!require(gganimate)) install.packages('gganimate')
library(gganimate)
if(!require(gifski)) install.packages('gifski')
library(gifski)
staticplot = ggplot(milk_production_states_1, aes(rank)) +
geom_tile(aes(y = value / 2, height = value, width = 0.9, fill = as.factor(Regions)), alpha = 0.8) +
geom_text(aes(y = value, label = Brazilian_States, size = 5, position = position_nudge(y = -300000))) +
geom_text(aes(y = value, label = as.character(Value_lbl)), size = 7, position = position_nudge(y = 250000)) +
coord_flip(clip = "off", expand = FALSE) +
scale_x_reverse() +
guides(color = FALSE, fill = FALSE) +
theme(legend.position = "right",
legend.key.width = unit(3, "cm"),
legend.key.size = unit(3, "cm"),
legend.title = element_text(hjust = 0.5, size = 20),
legend.text = element_text(size = 18),
axis.text.x = element_blank(),
axis.text.y = element_blank(),
axis.ticks = element_blank(),
axis.title.x = element_blank(),
axis.title.y = element_blank(),
panel.background = element_blank(),
plot.background = element_blank(),
panel.grid.major.y = element_blank(),
panel.border = element_blank(),
panel.grid.minor.x = element_line(size =.1, color = "grey" ),
plot.title = element_text(size = 20, hjust = 0.5, face = "bold", colour = "black"),
plot.subtitle = element_text(size = 14, hjust = 0.5, face = "italic", color = "black"),
plot.caption = element_text(size = 15, hjust = 0.5, face = "italic", color = "black"))
anim = staticplot +
transition_time(year)+
view_follow(fixed_x = TRUE)  +
labs(title = 'Milk Production in Brazilian States (Billions of Liters): {round(frame_time)}',
subtitle = "Top 10 States",
caption = "Milk Production in Brazilian States in Billions of Liters | Source: Brazilian Institute of Statistics and Geography.")
library(ggplot2)
milk_production_states <- read.csv2('spreadsheet/table74_brazil.csv', skip = 3, nrows = 31, stringsAsFactors = FALSE, encoding = "UTF-8")
milk_production_states <- milk_production_states[-(1:2),]
milk_production_states <- milk_production_states[-29,]
colnames(milk_production_states) <- gsub("X", '', colnames(milk_production_states))
colnames(milk_production_states)[1] <- "Brazilian_States"
for(i in 2:ncol(milk_production_states)){
milk_production_states[,i] <- gsub("[...]", '0', milk_production_states[,i])
milk_production_states[,i] <- as.numeric(as.character(unlist(milk_production_states[,i])))
}
milk_production_states <- milk_production_states %>%
gather(year, value, 2:45)
milk_production_states$year <- as.numeric(milk_production_states$year)
milk_production_states_1 <- milk_production_states %>%
group_by(year) %>%
mutate(rank = rank(-value),
Value_lbl = paste0(" ", round((value * 1000) / 1000000000, 2))) %>%
filter(rank <= 10) %>%
ungroup()
if(!require(gganimate)) install.packages('gganimate')
library(gganimate)
if(!require(gifski)) install.packages('gifski')
library(gifski)
staticplot = ggplot(milk_production_states_1, aes(rank)) +
geom_tile(aes(y = value / 2, height = value, width = 0.9, fill = as.factor(Regions)), alpha = 0.8) +
geom_text(aes(y = value, label = Brazilian_States, size = 5, position = position_nudge(y = -300000))) +
geom_text(aes(y = value, label = as.character(Value_lbl)), size = 7, position = position_nudge(y = 250000)) +
coord_flip(clip = "off", expand = FALSE) +
scale_x_reverse() +
guides(color = FALSE, fill = FALSE) +
theme(legend.position = "right",
legend.key.width = unit(3, "cm"),
legend.key.size = unit(3, "cm"),
legend.title = element_text(hjust = 0.5, size = 20),
legend.text = element_text(size = 18),
axis.text.x = element_blank(),
axis.text.y = element_blank(),
axis.ticks = element_blank(),
axis.title.x = element_blank(),
axis.title.y = element_blank(),
panel.background = element_blank(),
plot.background = element_blank(),
panel.grid.major.y = element_blank(),
panel.border = element_blank(),
panel.grid.minor.x = element_line(size =.1, color = "grey" ),
plot.title = element_text(size = 20, hjust = 0.5, face = "bold", colour = "black"),
plot.subtitle = element_text(size = 14, hjust = 0.5, face = "italic", color = "black"),
plot.caption = element_text(size = 15, hjust = 0.5, face = "italic", color = "black"))
anim = staticplot +
transition_time(year)+
view_follow(fixed_x = TRUE)  +
labs(title = 'Milk Production in Brazilian States (Billions of Liters): {round(frame_time)}',
subtitle = "Top 10 States",
caption = "Milk Production in Brazilian States in Billions of Liters | Source: Brazilian Institute of Statistics and Geography.")
animate(anim, 110, fps = 44, width = 1600, height = 1200, renderer = gifski_renderer("gganim.gif", loop = FALSE)) +  ease_aes('cubic-in-out')
View(milk_production_states)
View(milk_production_states_1)
milk_production_states <- read.csv2('spreadsheet/table74_brazil.csv', skip = 3, nrows = 31, stringsAsFactors = FALSE, encoding = "UTF-8")
milk_production_states <- milk_production_states[-(1:2),]
milk_production_states <- milk_production_states[-29,]
colnames(milk_production_states) <- gsub("X", '', colnames(milk_production_states))
colnames(milk_production_states)[1] <- "Brazilian_States"
for(i in 2:ncol(milk_production_states)){
milk_production_states[,i] <- gsub("[...]", '0', milk_production_states[,i])
milk_production_states[,i] <- as.numeric(as.character(unlist(milk_production_states[,i])))
}
Regions <- c(rep("N", 7), rep("NE", 9), rep("SE", 4), rep("S", 3), rep("MW", 4))
milk_production_states <- cbind(milk_production_states, Regions)
milk_production_states
milk_production_states <- milk_production_states %>%
gather(year, value, 2:45)
milk_production_states$year <- as.numeric(milk_production_states$year)
milk_production_states_1 <- milk_production_states %>%
group_by(year) %>%
mutate(rank = rank(-value),
Value_lbl = paste0(" ", round((value * 1000) / 1000000000, 2))) %>%
filter(rank <= 10) %>%
ungroup()
if(!require(gganimate)) install.packages('gganimate')
library(gganimate)
if(!require(gifski)) install.packages('gifski')
library(gifski)
staticplot = ggplot(milk_production_states_1, aes(rank)) +
geom_tile(aes(y = value / 2, height = value, width = 0.9, fill = as.factor(Regions)), alpha = 0.8) +
geom_text(aes(y = value, label = Brazilian_States, size = 5, position = position_nudge(y = -300000))) +
geom_text(aes(y = value, label = as.character(Value_lbl)), size = 7, position = position_nudge(y = 250000)) +
coord_flip(clip = "off", expand = FALSE) +
scale_x_reverse() +
guides(color = FALSE, fill = FALSE) +
theme(legend.position = "right",
legend.key.width = unit(3, "cm"),
legend.key.size = unit(3, "cm"),
legend.title = element_text(hjust = 0.5, size = 20),
legend.text = element_text(size = 18),
axis.text.x = element_blank(),
axis.text.y = element_blank(),
axis.ticks = element_blank(),
axis.title.x = element_blank(),
axis.title.y = element_blank(),
panel.background = element_blank(),
plot.background = element_blank(),
panel.grid.major.y = element_blank(),
panel.border = element_blank(),
panel.grid.minor.x = element_line(size =.1, color = "grey" ),
plot.title = element_text(size = 20, hjust = 0.5, face = "bold", colour = "black"),
plot.subtitle = element_text(size = 14, hjust = 0.5, face = "italic", color = "black"),
plot.caption = element_text(size = 15, hjust = 0.5, face = "italic", color = "black"))
anim = staticplot +
transition_time(year)+
view_follow(fixed_x = TRUE)  +
labs(title = 'Milk Production in Brazilian States (Billions of Liters): {round(frame_time)}',
subtitle = "Top 10 States",
caption = "Milk Production in Brazilian States in Billions of Liters | Source: Brazilian Institute of Statistics and Geography.")
animate(anim, 110, fps = 44, width = 1600, height = 1200, renderer = gifski_renderer("gganim.gif", loop = FALSE)) +  ease_aes('cubic-in-out')
View(milk_production_states_1)
milk_production_states <- read.csv2('spreadsheet/table74_brazil.csv', skip = 3, nrows = 31, stringsAsFactors = FALSE, encoding = "UTF-8")
milk_production_states <- milk_production_states[-(1:2),]
milk_production_states <- milk_production_states[-29,]
colnames(milk_production_states) <- gsub("X", '', colnames(milk_production_states))
colnames(milk_production_states)[1] <- "Brazilian_States"
for(i in 2:ncol(milk_production_states)){
milk_production_states[,i] <- gsub("[...]", '0', milk_production_states[,i])
milk_production_states[,i] <- as.numeric(as.character(unlist(milk_production_states[,i])))
}
Regions <- c(rep("N", 7), rep("NE", 9), rep("SE", 4), rep("S", 3), rep("MW", 4))
milk_production_states <- cbind(milk_production_states, Regions)
milk_production_states
View(milk_production_states)
milk_production_states <- read.csv2('spreadsheet/table74_brazil.csv', skip = 3, nrows = 31, stringsAsFactors = FALSE, encoding = "UTF-8")
milk_production_states <- milk_production_states[-(1:2),]
milk_production_states <- milk_production_states[-29,]
colnames(milk_production_states) <- gsub("X", '', colnames(milk_production_states))
colnames(milk_production_states)[1] <- "Brazilian_States"
for(i in 2:ncol(milk_production_states)){
milk_production_states[,i] <- gsub("[...]", '0', milk_production_states[,i])
milk_production_states[,i] <- as.numeric(as.character(unlist(milk_production_states[,i])))
}
milk_production_states <- milk_production_states[-20,]
milk_production_states
Regions <- c(rep("N", 7), rep("NE", 9), rep("SE", 4), rep("S", 3), rep("MW", 4))
milk_production_states <- cbind(milk_production_states, Regions)
milk_production_states
milk_production_states <- milk_production_states %>%
gather(year, value, 2:45)
milk_production_states$year <- as.numeric(milk_production_states$year)
milk_production_states_1 <- milk_production_states %>%
group_by(year) %>%
mutate(rank = rank(-value),
Value_lbl = paste0(" ", round((value * 1000) / 1000000000, 2))) %>%
filter(rank <= 10) %>%
ungroup()
if(!require(gganimate)) install.packages('gganimate')
library(gganimate)
if(!require(gifski)) install.packages('gifski')
library(gifski)
staticplot = ggplot(milk_production_states_1, aes(rank)) +
geom_tile(aes(y = value / 2, height = value, width = 0.9, fill = as.factor(Regions)), alpha = 0.8) +
geom_text(aes(y = value, label = Brazilian_States, size = 5, position = position_nudge(y = -300000))) +
geom_text(aes(y = value, label = as.character(Value_lbl)), size = 7, position = position_nudge(y = 250000)) +
coord_flip(clip = "off", expand = FALSE) +
scale_x_reverse() +
guides(color = FALSE, fill = FALSE) +
theme(legend.position = "right",
legend.key.width = unit(3, "cm"),
legend.key.size = unit(3, "cm"),
legend.title = element_text(hjust = 0.5, size = 20),
legend.text = element_text(size = 18),
axis.text.x = element_blank(),
axis.text.y = element_blank(),
axis.ticks = element_blank(),
axis.title.x = element_blank(),
axis.title.y = element_blank(),
panel.background = element_blank(),
plot.background = element_blank(),
panel.grid.major.y = element_blank(),
panel.border = element_blank(),
panel.grid.minor.x = element_line(size =.1, color = "grey" ),
plot.title = element_text(size = 20, hjust = 0.5, face = "bold", colour = "black"),
plot.subtitle = element_text(size = 14, hjust = 0.5, face = "italic", color = "black"),
plot.caption = element_text(size = 15, hjust = 0.5, face = "italic", color = "black"))
anim = staticplot +
transition_time(year)+
view_follow(fixed_x = TRUE)  +
labs(title = 'Milk Production in Brazilian States (Billions of Liters): {round(frame_time)}',
subtitle = "Top 10 States",
caption = "Milk Production in Brazilian States in Billions of Liters | Source: Brazilian Institute of Statistics and Geography.")
animate(anim, 110, fps = 44, width = 1600, height = 1200, renderer = gifski_renderer("gganim.gif", loop = FALSE)) +  ease_aes('cubic-in-out')
View(milk_production_states_1)
staticplot = ggplot(milk_production_states_1, aes(rank)) +
geom_tile(aes(y = value / 2, height = value, width = 0.9, fill = as.factor(Regions)), alpha = 0.8) +
geom_text(aes(y = value, label = Brazilian_States, size = 5, nudge_y = -300000)) +
geom_text(aes(y = value, label = as.character(Value_lbl)), size = 7, nudge_y = 250000) +
coord_flip(clip = "off", expand = FALSE) +
scale_x_reverse() +
guides(color = FALSE, fill = FALSE) +
theme(legend.position = "right",
legend.key.width = unit(3, "cm"),
legend.key.size = unit(3, "cm"),
legend.title = element_text(hjust = 0.5, size = 20),
legend.text = element_text(size = 18),
axis.text.x = element_blank(),
axis.text.y = element_blank(),
axis.ticks = element_blank(),
axis.title.x = element_blank(),
axis.title.y = element_blank(),
panel.background = element_blank(),
plot.background = element_blank(),
panel.grid.major.y = element_blank(),
panel.border = element_blank(),
panel.grid.minor.x = element_line(size =.1, color = "grey" ),
plot.title = element_text(size = 20, hjust = 0.5, face = "bold", colour = "black"),
plot.subtitle = element_text(size = 14, hjust = 0.5, face = "italic", color = "black"),
plot.caption = element_text(size = 15, hjust = 0.5, face = "italic", color = "black"))
anim = staticplot +
transition_time(year)+
view_follow(fixed_x = TRUE)  +
labs(title = 'Milk Production in Brazilian States (Billions of Liters): {round(frame_time)}',
subtitle = "Top 10 States",
caption = "Milk Production in Brazilian States in Billions of Liters | Source: Brazilian Institute of Statistics and Geography.")
animate(anim, 110, fps = 44, width = 1600, height = 1200, renderer = gifski_renderer("gganim.gif", loop = FALSE)) +  ease_aes('cubic-in-out')
View(milk_production_states_1)
staticplot = ggplot(milk_production_states_1, aes(rank)) +
geom_tile(aes(y = value / 2, height = value, width = 0.9, fill = Regions), alpha = 0.8) +
geom_text(aes(y = value, label = Brazilian_States, size = 5, nudge_y = -400000)) +
geom_text(aes(y = value, label = as.character(Value_lbl)), size = 7, nudge_y = 250000) +
coord_flip(clip = "off", expand = FALSE) +
scale_x_reverse() +
guides(color = FALSE, fill = FALSE) +
theme(legend.position = "right",
legend.key.width = unit(3, "cm"),
legend.key.size = unit(3, "cm"),
legend.title = element_text(hjust = 0.5, size = 20),
legend.text = element_text(size = 18),
axis.text.x = element_blank(),
axis.text.y = element_blank(),
axis.ticks = element_blank(),
axis.title.x = element_blank(),
axis.title.y = element_blank(),
panel.background = element_blank(),
plot.background = element_blank(),
panel.grid.major.y = element_blank(),
panel.border = element_blank(),
panel.grid.minor.x = element_line(size =.1, color = "grey" ),
plot.title = element_text(size = 20, hjust = 0.5, face = "bold", colour = "black"),
plot.subtitle = element_text(size = 14, hjust = 0.5, face = "italic", color = "black"),
plot.caption = element_text(size = 15, hjust = 0.5, face = "italic", color = "black"))
anim = staticplot +
transition_time(year)+
view_follow(fixed_x = TRUE)  +
labs(title = 'Milk Production in Brazilian States (Billions of Liters): {round(frame_time)}',
subtitle = "Top 10 States",
caption = "Milk Production in Brazilian States in Billions of Liters | Source: Brazilian Institute of Statistics and Geography.")
animate(anim, 110, fps = 44, width = 1600, height = 1200, renderer = gifski_renderer("gganim.gif", loop = FALSE)) +  ease_aes('cubic-in-out')
staticplot <- ggplot(milk_production_states_1, aes(x = rank)) +
geom_tile(aes(y = value / 2 , height = value, width = 0.9, fill = as.factor(Regions)), alpha = 0.9) +
geom_text(aes(y = value, label = Brazilian_States), size = 5, nudge_y = -300000) +
geom_text(aes(y = value, label = as.character(Value_lbl)), size = 7, nudge_y = 250000) +
coord_flip(clip = "off", expand = FALSE) +
scale_x_reverse() +
labs(fill = "Region") +
theme(legend.position = "right",
legend.key.width = unit(3, "cm"),
legend.key.size = unit(3, "cm"),
legend.title = element_text(hjust = 0.5, size = 20),
legend.text = element_text(size = 18),
axis.text.x = element_blank(),
axis.text.y = element_blank(),
axis.ticks = element_blank(),
axis.title.x = element_blank(),
axis.title.y = element_blank(),
panel.background = element_blank(),
plot.background = element_blank(),
panel.grid.major.y = element_blank(),
panel.border = element_blank(),
panel.grid.minor.x = element_line(size =.1, color = "grey" ),
plot.title = element_text(size = 20, hjust = 0.5, face = "bold", colour = "black"),
plot.subtitle = element_text(size = 14, hjust = 0.5, face = "italic", color = "black"),
plot.caption = element_text(size = 15, hjust = 0.5, face = "italic", color = "black"))
anim <- staticplot +
transition_time(year) +
view_follow(fixed_x = TRUE)  +
labs(title = 'Milk Production in Brazilian States (Billions of Liters): {round(frame_time)}',
subtitle = "Top 10 States",
caption = "Milk Production in Brazilian States in Billions of Liters | Source: Brazilian Institute of Statistics and Geography.")
animate(anim, 110, fps = 44, width = 1700, height = 1000, renderer = gifski_renderer("gganim1111.gif", loop = FALSE)) +
ease_aes('cubic-in-out')
animate(anim, 440, fps = 22, width = 1700, height = 1000, renderer = gifski_renderer("gganim1111.gif", loop = FALSE)) +
ease_aes('cubic-in-out')
View(milk_production_states)
staticplot <- ggplot(milk_production_states_1, aes(x = rank, group = Regions)) +
geom_tile(aes(y = value / 2 , height = value, width = 0.9, fill = as.factor(Regions)), alpha = 0.9) +
geom_text(aes(y = value, label = Brazilian_States), size = 5, nudge_y = -300000) +
geom_text(aes(y = value, label = as.character(Value_lbl)), size = 7, nudge_y = 250000) +
coord_flip(clip = "off", expand = FALSE) +
scale_x_reverse() +
labs(fill = "Region") +
theme(legend.position = "right",
legend.key.width = unit(3, "cm"),
legend.key.size = unit(3, "cm"),
legend.title = element_text(hjust = 0.5, size = 20),
legend.text = element_text(size = 18),
axis.text.x = element_blank(),
axis.text.y = element_blank(),
axis.ticks = element_blank(),
axis.title.x = element_blank(),
axis.title.y = element_blank(),
panel.background = element_blank(),
plot.background = element_blank(),
panel.grid.major.y = element_blank(),
panel.border = element_blank(),
panel.grid.minor.x = element_line(size =.1, color = "grey" ),
plot.title = element_text(size = 20, hjust = 0.5, face = "bold", colour = "black"),
plot.subtitle = element_text(size = 14, hjust = 0.5, face = "italic", color = "black"),
plot.caption = element_text(size = 15, hjust = 0.5, face = "italic", color = "black"))
anim <- staticplot +
transition_time(year) +
view_follow(fixed_x = TRUE)  +
labs(title = 'Milk Production in Brazilian States (Billions of Liters): {round(frame_time)}',
subtitle = "Top 10 States",
caption = "Milk Production in Brazilian States in Billions of Liters | Source: Brazilian Institute of Statistics and Geography.")
animate(anim, 110, fps = 22, width = 1700, height = 1000, renderer = gifski_renderer("gganim1111.gif", loop = FALSE)) +
ease_aes('cubic-in-out')
staticplot <- ggplot(milk_production_states_1, aes(x = rank, group = Regions)) +
geom_tile(aes(y = value / 2 , height = value, width = 0.9, fill = as.factor(Regions)), alpha = 0.9) +
geom_text(aes(y = value, label = Brazilian_States), size = 5, nudge_y = -300000) +
geom_text(aes(y = value, label = as.character(Value_lbl)), size = 7, nudge_y = 250000) +
coord_flip(clip = "off", expand = FALSE) +
scale_x_reverse() +
labs(fill = "Region") +
theme(legend.position = "right",
legend.key.width = unit(3, "cm"),
legend.key.size = unit(3, "cm"),
legend.title = element_text(hjust = 0.5, size = 20),
legend.text = element_text(size = 18),
axis.text.x = element_blank(),
axis.text.y = element_blank(),
axis.ticks = element_blank(),
axis.title.x = element_blank(),
axis.title.y = element_blank(),
panel.background = element_blank(),
plot.background = element_blank(),
panel.grid.major.y = element_blank(),
panel.border = element_blank(),
panel.grid.minor.x = element_line(size =.1, color = "grey" ),
plot.title = element_text(size = 20, hjust = 0.5, face = "bold", colour = "black"),
plot.subtitle = element_text(size = 14, hjust = 0.5, face = "italic", color = "black"),
plot.caption = element_text(size = 15, hjust = 0.5, face = "italic", color = "black"))
anim <- staticplot +
transition_time(year) +
view_follow(fixed_x = TRUE)  +
labs(title = 'Milk Production in Brazilian States (Billions of Liters): {round(frame_time)}',
subtitle = "Top 10 States",
caption = "Milk Production in Brazilian States in Billions of Liters | Source: Brazilian Institute of Statistics and Geography.")
animate(anim, 880, fps = 44, width = 1700, height = 1000, renderer = gifski_renderer("gganim1111.gif", loop = FALSE)) +
ease_aes('cubic-in-out')
